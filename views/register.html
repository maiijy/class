<%--
  Created by IntelliJ IDEA.
  User: wuli等等
  Date: 2017/9/24
  Time: 15:48
  To change this template use File | Settings | File Templates.
--%>
<html lang="en">
<head>
    <meta name="description" content="用户注册"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../images/favicon.ico">
    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- artDialog -->
    <link href="../css/artDialog_simple.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/jquery.bxslider.css" rel="stylesheet">
    <link href="../styles/register.css" rel="stylesheet">
    <title>注册</title>
</head>
<body>
<div class="container">
    <div id="main">
        <div class="row logoNav" id="logoNav">
            <div class="col-sm-5">
                <p>用户注册</p>
            </div>
            <div class="col-sm-3 col-sm-offset-4">
                <img src="../images/logo2.png" class=" myLogo">
            </div>
        </div>

        <div class="form-horizontal" role="form">
            <div class="form-group">
                <label for="username" class="col-sm-3 control-label">用户名</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="username" name="username" placeholder="请输入用户名" autofocus required oninvalid="setCustomValidity('请输入用户名！');" oninput="setCustomValidity('');">
                </div>
            </div>
            <div class="form-group">
                <label for="password" class="col-sm-3 control-label">密码</label>
                <div class="col-sm-8">
                    <input type="password" class="form-control" id="password" name="password" placeholder="请输入密码"  required oninvalid="setCustomValidity('请输入密码！');" oninput="setCustomValidity('');">
                </div>
            </div>
            <div class="form-group">
                <label for="rpw" class="col-sm-3 control-label">确认密码</label>
                <div class="col-sm-8">
                    <input type="password" class="form-control" id="rpw" placeholder="请再次输入密码"  required oninvalid="setCustomValidity('请确认密码！');" oninput="setCustomValidity('');">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-9">
                    <a href="/login">已有账号，去登录</a>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-4">
                    <button id="submitBtn" class="btn  btn-success">&nbsp&nbsp注册&nbsp&nbsp  </button>
                </div>
                <div class="col-sm-4">
                    <button id="reset" class="btn  btn-warning">&nbsp&nbsp重置&nbsp&nbsp</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="http://cdn.static.runoob.com/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="../js/jquery.artDialog.js"></script>
<script>
    $(function () {
            $("#submitBtn").click(function () {
                var username = $("#username").val();
                var password = $("#password").val();
                var rpw = $("#rpw").val();
                if(username != "" && password != "" && rpw != "") {
                if (password === rpw) {
                    console.log(username);
                    $.ajax({
                        type: "POST",                   //类型，POST或者GET
                        url: "/register",        //后台url
                        data: {                          //数据
                            username: username,
                            password: password
                        },
                        dataType: 'json',              //数据返回类型，可以是xml、json等
                        success: function (data) {      //成功，回调函数
                            console.log(data);
                            if (data.result == '1') {
                                var dialog = art.dialog({
                                    title: '提示',
                                    content: '注册成功，即将跳转到登录页面！',
                                    lock:true,
                                    follow: document.getElementById('logoNav'),
                                    time:3
                                });
                                location.href = "/login";
                            } else if (data.result == '2') {
                                alert("该账号已存在！");
                                reset();
                            }
                            else {
                                alert('未知错误，注册失败！');
                                reset();
                            }
                        },
                        error: function (err) {          //失败，回调函数
                            console.log(err);
                        }
                    });
                }else {
                    alert("两次输入的密码不一致，请再次确认密码！");
                    $("#rpw").val("");
                }
                }
            });

            //回车事件
             $(document).keyup(function(event){
            if(event.keyCode ==13){
                $("#submitBtn").trigger("click");
               }
             });

            //重置按钮实现
            $("#reset").click(function () {
                reset();
            });

            //清空input
            var reset = function () {
                $("#username").val("");
                $("#password").val("");
                $("#rpw").val("");
            }

    })
</script>
</body>
</html>
