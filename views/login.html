<%--
  Created by IntelliJ IDEA.
  User: wuli等等
  Date: 2017/9/25
  Time: 20:13
  To change this template use File | Settings | File Templates.
--%>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="用户登录"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../images/favicon.ico">
    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- artDialog -->
    <link href="../css/artDialog_simple.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/jquery.bxslider.css" rel="stylesheet">
    <link href="../styles/register.css" rel="stylesheet">

    <title>登录</title>
</head>
<body>
<div class="container">
    <div id="main">
        <div class="row logoNav" id="logoNav">
            <div class="col-sm-5">
                <p>登录</p>
            </div>
            <div class="col-sm-3 col-sm-offset-4">
                <img src="../images/logo2.png" class=" myLogo">
            </div>
        </div>

        <div class="form-horizontal" role="form">
            <div class="form-group">
                <label for="username" class="col-sm-3 control-label">用户名</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="username" name="username" placeholder="请输入用户名" autofocus required oninvalid="setCustomValidity('请输入用户名！');" oninput="setCustomValidity('');">
                </div>
            </div>
            <div class="form-group">
                <label for="password" class="col-sm-3 control-label">密码</label>
                <div class="col-sm-8">
                    <input type="password" class="form-control" id="password" name="password" placeholder="请输入密码"  required oninvalid="setCustomValidity('请输入密码！');" oninput="setCustomValidity('');">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-4">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox">记住密码
                        </label>
                    </div>
                </div>
                <div class="col-md-offset-2 col-sm-3">
                    <a href="/register">
                        去注册
                    </a>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-5 col-sm-7">
                    <button id="login" class="btn  btn-success">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp登录&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp  </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="http://cdn.static.runoob.com/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="../js/jquery.artDialog.js"></script>
<script src="../js/xSlider.js"></script>
<script>
    $(function () {
        $("#login").click(function () {
            var username = $("#username").val();
            var password = $("#password").val();
            if(username == ""){
                var dialog = art.dialog({
                    title: '提示',
                    content: '请输入用户名！',
                    lock:true,
                    ok:true,
                    follow: document.getElementById('logoNav')
                });
            }else if(password == ""){
                var dialog = art.dialog({
                    title: '提示',
                    content: '请输入密码！',
                    lock:true,
                    ok:true,
                    follow: document.getElementById('logoNav')
                });
            }
            if(username != "" && password != "") {
                    $.ajax({
                        type: "POST",                   //类型，POST或者GET
                        url: "/login",        //后台url
                        data: {                          //数据
                            username: username,
                            password: password
                        },
                        dataType: 'json',              //数据返回类型，可以是xml、json等
                        success: function (data) {      //成功，回调函数
                            console.log(data);
                            if (data.result == '0') {
                                var dialog = art.dialog({
                                    title: '提示',
                                    content: '该用户不存在，请重新输入！',
                                    lock:true,
                                    ok:true,
                                    follow: document.getElementById('logoNav')
                                });
                                reset();
                            } else if (data.result == '1') {
                                var dialog = art.dialog({
                                    title: '提示',
                                    content: '密码错误，请重新输入！',
                                    lock:true,
                                    ok:true,
                                    follow: document.getElementById('logoNav')
                                });
                                $("#password").val("");
                            } else if(data.result == '2'){
                                location.href = ("/index");
                            }else {
                                alert('未知错误，登录失败！');
                                reset();
                            }
                        },
                        error: function (err) {          //失败，回调函数
                            alert('未知错误，登录失败！');
                            console.log(err);
                        }
                    });
                }
        });

        //回车事件
        $(document).keyup(function(event){
            if(event.keyCode ==13){
                $("#login").trigger("click");
            }
        });


    })
</script>
</body>
</html>
